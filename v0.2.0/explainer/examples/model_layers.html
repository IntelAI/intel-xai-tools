<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Explaining Language Model Activations &mdash; Explainer</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" type="text/css" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script src="../../_static/design-tabs.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.9.1/mermaid.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Quick Start" href="../quickstart.html" />
    <link rel="prev" title="Explaining Text Classification" href="partitionexplainer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Intel® Explainable AI Tools
          </a>
              <div class="version">
                0.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Explainer</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../explanations.html">Explanations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ExplainingDeepLearningModels.html">Explaining Deep Learning Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="partitionexplainer.html">Explaining Text Classification</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Explaining Language Model Activations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli.html">CLI Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bibliography/index.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../model_card_gen/index.html">Model Card Generator</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Intel® Explainable AI Tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Explainer</a> &raquo;</li>
          <li><a href="index.html">Examples</a> &raquo;</li>
      <li>Explaining Language Model Activations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/explainer/examples/model_layers.ipynb" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="explaining-language-model-activations">
<h1>Explaining Language Model Activations<a class="headerlink" href="#explaining-language-model-activations" title="Permalink to this heading"></a></h1>
<section id="see-the-ecco-toolkitalammar-2021-ecco">
<h2>See the <a class="reference external" href="https://ecco.readthedocs.io/en/main/">ecco toolkit</a><span id="id1">[<a class="reference internal" href="../bibliography/index.html#id13" title="J Alammar. Ecco: an open source library for the explainability of transformer language models. In Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing: System Demonstrations. Association for Computational Linguistics, 2021.">Ala21</a>]</span><a class="headerlink" href="#see-the-ecco-toolkitalammar-2021-ecco" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">explainer.explainers</span> <span class="kn">import</span> <span class="n">lm_layers_explainer</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;KMP_WARNINGS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;off&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_layers_explainer</span><span class="o">.</span><span class="n">entry_points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer &#39;explainer.explainers.lm_layers_explainer&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-activations-in-each-layer-in-the-model">
<h2>Show activations in each layer in the model<a class="headerlink" href="#show-activations-in-each-layer-in-the-model" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;bert-base-uncased&#39;</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; </span>
<span class="s1">Now I ask you: what can be expected of man since he is a being endowed with strange qualities? </span>
<span class="s1">Shower upon him every earthly blessing, drown him in a sea of happiness, so that nothing but bubbles of bliss </span>
<span class="s1">can be seen on the surface; give him economic prosperity, such that he should have nothing else to do but sleep, </span>
<span class="s1">eat cakes and busy himself with the continuation of his species, and even then out of sheer ingratitude, sheer spite, </span>
<span class="s1">man would play you some nasty trick. He would even risk his cakes and would deliberately desire the most fatal rubbish, </span>
<span class="s1">the most uneconomical absurdity, simply to introduce into all this positive good sense his fatal fantastic element. </span>
<span class="s1">It is just his fantastic dreams, his vulgar folly that he will desire to retain, simply in order to prove to himself--as though that were so necessary-- </span>
<span class="s1">that men still are men and not the keys of a piano, which the laws of nature threaten to control so completely that soon one will be able to desire nothing but by the calendar. </span>
<span class="s1">And that is not all: even if man really were nothing but a piano-key, even if this were proved to him by natural science and mathematics, even then he would not become reasonable,</span>
<span class="s1">but would purposely do something perverse out of simple ingratitude, simply to gain his point. And if he does not find means he will contrive destruction and chaos, will </span>
<span class="s1">contrive sufferings of all sorts, only to gain his point! He will launch a curse upon the world, and as only man can curse (it is his privilege, the primary distinction </span>
<span class="s1">between him and other animals), may be by his curse alone he will attain his object--that is, convince himself that he is a man and not a piano-key!</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">activations</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;activations&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">activations</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer key=activations KeyError(&#39;explainer.explainers.lm_layers_explainer&#39;)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">16</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;bert-base-uncased&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; </span>
<span class="g g-Whitespace">      </span><span class="mi">3</span><span class="s1"> Now I ask you: what can be expected of man since he is a being endowed with strange qualities? </span>
<span class="g g-Whitespace">      </span><span class="mi">4</span><span class="s1"> Shower upon him every earthly blessing, drown him in a sea of happiness, so that nothing but bubbles of bliss </span>
<span class="s1">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span><span class="s1"> between him and other animals), may be by his curse alone he will attain his object--that is, convince himself that he is a man and not a piano-key!</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span><span class="s1"> &#39;&#39;&#39;</span>
<span class="ne">---&gt; </span><span class="mi">16</span> <span class="n">activations</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;activations&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="n">activations</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="ne">TypeError</span>: &#39;NoneType&#39; object is not callable
</pre></div>
</div>
</div>
</div>
</section>
<section id="fill-in-the-blank-heathrow-airport-is-located-in-the-city-of">
<h2>Fill in the blank: “Heathrow airport is located in the city of __”<a class="headerlink" href="#fill-in-the-blank-heathrow-airport-is-located-in-the-city-of" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;distilgpt2&#39;</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; Heathrow airport is in the city of&quot;</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer key=predictions KeyError(&#39;explainer.explainers.lm_layers_explainer&#39;)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;distilgpt2&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; Heathrow airport is in the city of&quot;</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

<span class="ne">TypeError</span>: &#39;NoneType&#39; object is not callable
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-candidate-tokens-at-the-last-layer-of-the-model-layer-5">
<h2>Visualize the candidate tokens at the last layer of the model (layer 5)<a class="headerlink" href="#visualize-the-candidate-tokens-at-the-last-layer-of-the-model-layer-5" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">predictions</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;predictions&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="we-can-see-more-tokens-using-the-topk-parameter">
<h2>We can see more tokens using the topk parameter<a class="headerlink" href="#we-can-see-more-tokens-using-the-topk-parameter" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">topk</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">predictions</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">topk</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;predictions&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-candidate-tokens-at-every-layer">
<h2>Visualize the candidate tokens at every layer<a class="headerlink" href="#visualize-the-candidate-tokens-at-every-layer" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">predictions</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;predictions&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-rankings-for-the-next-word">
<h2>Show rankings for the next word<a class="headerlink" href="#show-rankings-for-the-next-word" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;distilgpt2&#39;</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The keys to the cabinet&quot;</span>
<span class="n">rankings</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;rankings&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>
<span class="n">rankings</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">generate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">do_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rankings_watch</span><span class="p">(</span><span class="n">watch</span><span class="o">=</span><span class="p">[</span><span class="mi">318</span><span class="p">,</span> <span class="mi">389</span><span class="p">],</span> <span class="n">position</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer key=rankings KeyError(&#39;explainer.explainers.lm_layers_explainer&#39;)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;distilgpt2&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The keys to the cabinet&quot;</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">rankings</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;rankings&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">rankings</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">generate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">do_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">rankings_watch</span><span class="p">(</span><span class="n">watch</span><span class="o">=</span><span class="p">[</span><span class="mi">318</span><span class="p">,</span> <span class="mi">389</span><span class="p">],</span> <span class="n">position</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="ne">TypeError</span>: &#39;NoneType&#39; object is not callable
</pre></div>
</div>
</div>
</div>
</section>
<section id="attention-head-view">
<h2>Attention head view<a class="headerlink" href="#attention-head-view" title="Permalink to this heading"></a></h2>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Hover over any token on the left/right side of the visualization to filter attention from/to that token. The colors correspond to different attention heads.</p></li>
<li><p>Double-click on any of the colored tiles at the top to filter to the corresponding attention head.</p></li>
<li><p>Single-click on any of the colored tiles to toggle selection of the corresponding attention head.</p></li>
<li><p>Click on the Layer drop-down to change the model layer (zero-indexed).</p></li>
<li><p>The lines show the attention from each token (left) to every other token (right). Darker lines indicate higher attention weights. When multiple heads are selected, the attention weights are overlaid on one another.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;bert-base-uncased&#39;</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The cat sat on the mat&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_head_view&#39;</span><span class="p">]</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="n">head_view</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_head_view&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>

<span class="n">head_view</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer key=attention_head_view KeyError(&#39;explainer.explainers.lm_layers_explainer&#39;)
ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer key=attention_head_view KeyError(&#39;explainer.explainers.lm_layers_explainer&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>None
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The cat sat on the mat&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="nb">print</span><span class="p">(</span><span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_head_view&#39;</span><span class="p">]</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">head_view</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_head_view&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">head_view</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="ne">TypeError</span>: &#39;NoneType&#39; object is not callable
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;bert-base-uncased&#39;</span>
<span class="n">sentence_a</span> <span class="o">=</span> <span class="s2">&quot;The cat sat on the mat&quot;</span>
<span class="n">sentence_b</span> <span class="o">=</span> <span class="s2">&quot;The cat lay on the rug&quot;</span>
<span class="n">neuron_view</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_neuron_view&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>
<span class="n">neuron_view</span><span class="p">(</span><span class="n">sentence_a</span><span class="p">,</span> <span class="n">sentence_b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer key=attention_neuron_view KeyError(&#39;explainer.explainers.lm_layers_explainer&#39;)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sentence_a</span> <span class="o">=</span> <span class="s2">&quot;The cat sat on the mat&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">sentence_b</span> <span class="o">=</span> <span class="s2">&quot;The cat lay on the rug&quot;</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">neuron_view</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_neuron_view&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">neuron_view</span><span class="p">(</span><span class="n">sentence_a</span><span class="p">,</span> <span class="n">sentence_b</span><span class="p">)</span>

<span class="ne">TypeError</span>: &#39;NoneType&#39; object is not callable
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;facebook/bart-large-cnn&#39;</span>
<span class="n">sentence_a</span> <span class="o">=</span> <span class="s2">&quot;The House Budget Committee voted Saturday to pass a $3.5 trillion spending bill&quot;</span>
<span class="n">sentence_b</span> <span class="o">=</span> <span class="s2">&quot;The House Budget Committee passed a spending bill.&quot;</span>
<span class="n">model_view</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_model_view&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>
<span class="n">model_view</span><span class="p">(</span><span class="n">sentence_a</span><span class="p">,</span> <span class="n">sentence_b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ExplainerModuleSpec KeyError group=explainer.explainers.lm_layers_explainer name=lm_layers_explainer key=attention_model_view KeyError(&#39;explainer.explainers.lm_layers_explainer&#39;)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sentence_a</span> <span class="o">=</span> <span class="s2">&quot;The House Budget Committee voted Saturday to pass a $3.5 trillion spending bill&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">sentence_b</span> <span class="o">=</span> <span class="s2">&quot;The House Budget Committee passed a spending bill.&quot;</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">model_view</span> <span class="o">=</span> <span class="n">lm_layers_explainer</span><span class="p">[</span><span class="s1">&#39;attention_model_view&#39;</span><span class="p">](</span><span class="n">model</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">model_view</span><span class="p">(</span><span class="n">sentence_a</span><span class="p">,</span> <span class="n">sentence_b</span><span class="p">)</span>

<span class="ne">TypeError</span>: &#39;NoneType&#39; object is not callable
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="partitionexplainer.html" class="btn btn-neutral float-left" title="Explaining Text Classification" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../quickstart.html" class="btn btn-neutral float-right" title="Quick Start" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>